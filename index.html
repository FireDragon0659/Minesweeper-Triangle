<!--
    æ‰«é›·ä¸‰è§’å½¢ç‰ˆæœ¬~
    ä½œè€…ï¼šã€å°ä¸‡æ³¥ã€xphostã€‘
    Githubï¼š[ç‚¹æˆ‘è¿›å…¥](https://github.com/FireDragon0659/Minesweeper-Triangle)
    æ“ç»ƒåœºï¼š[ç‚¹æˆ‘è¿›å…¥](https://FireDragon0659.github.io/Minesweeper-Triangle)
    å¦‚æœæœ‰ä»»ä½•ç–‘é—®æ¬¢è¿æ¥å‘æˆ‘æissue~
    æœ¬é¡¹ç›®æœ€ç»ˆç›®çš„ä¸ºã€æ­¦æ±‰å·¥ç¨‹èŒä¸šæŠ€æœ¯å­¦é™¢ã€‘çš„æ¯•ä¸šä¹‹ä½œ~
-->
<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>æ‰«é›·ï¼Œä½†æ˜¯æ˜¯ä¸‰è§’å½¢ç‰ˆæœ¬</title>
    <style>
        * {
            box-sizing: border-box;
            user-select: none;
        }

        #all {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        #chess {
            position: relative;
            padding: 0;
            overflow: auto;
            width: 740px;
            height: 740px;
            background-color: #f0f0f0;
        }

        #title {
            display: flex;
            align-items: center;
            width: 300px;
            justify-content: space-around;
        }

        .triangle,
        .triangle-click{
            position: absolute;
            width: 24px;
            height: 24px;
            border-bottom: 1px solid black;
            background-color: #e0e0e0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
        }
        .triangle-click {
            background-color: #b0b0b0;
        }
        .triangle:hover {
            background-color: #d0d0d0;
        }

        .triangle:active {
            background-color: #c0c0c0;
        }

        .triangle-up::before {
            position: absolute;
            content: '';
            width: 1px;
            height: 32px;
            top: -4px;
            left: 2px;
            background-color: black;
            transform-origin: 0 24px;
            transform: rotate(26.53deg);
        }

        .triangle-up::after {
            position: absolute;
            content: '';
            width: 1px;
            height: 32px;
            top: -13px;
            left: 19px;
            background-color: black;
            transform-origin: 24px 24px;
            transform: rotate(-26.53deg);
        }

        .triangle-up {
            clip-path: polygon(50% 0%, 0% 100%, 100% 100%);
            padding-top: 7px;
        }

        .triangle-down {
            clip-path: polygon(0% 0%, 100% 0%, 50% 100%);
            padding-bottom: 7px;
        }
        table tr td {
            width: 200px;
            height: 30px;
            max-height: 30px;
        }
    </style>
</head>
<body>
<div id="all">
    <div id="title">
        <table>
            <tr>
                <td><label for="side">è¯·è¾“å…¥è¾¹é•¿</label></td>
                <td><input id="side" placeholder="1åˆ°30" style="width: 200px" type="number" max="30" min="1"></td>
            </tr>
            <tr>
                <td><label for="mine">è¯·è¾“å…¥é›·æ•°</label></td>
                <td><input id="mine" placeholder="1åˆ°è¾¹é•¿çš„å¹³æ–¹-1" style="width: 200px" type="number" max="899" min="1"></td>
            </tr>
            <tr>
                <td><input id="cheat" type="checkbox"><label for="cheat">æ‰£åˆ†æ¨¡å¼</label></td>
                <td>
                    <button onclick="start()" style="width: 100%">å¼€å§‹æ¸¸æˆ</button>
                </td>
            </tr>
            <tr>
                <td style="text-align: right">åˆ†æ•°ï¼š<span id="score">0</span></td>
                <td style="text-align: right">æ—¶é—´ï¼š<span id="time">0</span></td>
            </tr>
            <tr>
                <td style="text-align: right">å‰©æ——ï¼š<span id="flag">0</span></td>
                <td style="text-align: right">è¾“èµ¢ï¼š<span id="win"></span></td>
            </tr>
        </table>
    </div>
    <div id="chess">
    </div>
</div>
<script>
    /**
     * æ‰«é›·ä¸‰è§’å½¢ç‰ˆæœ¬ï¼š
     * ä»¥æ­£ä¸‰è§’å½¢ä¸ºæ¨¡æ¿ã€‚åœ¨å‘¨å›´12æ ¼ä»¥å†…ç”Ÿæˆæ ¼å­ã€‚
     * ä¸‰è§’å½¢å†…æ•°å­—æœ€é«˜å¯ä»¥æœ‰12ã€‚åœ¨è§’è½é‡Œçš„ä¸‰è§’å½¢æœ€é«˜æ˜¯3ï¼Œåœ¨è¾¹ä¸Šçš„ä¸‰è§’å½¢æœ€é«˜æ˜¯7ã€‚
     * è®¡ç®—æ ¼å­æ€»æ•°çš„å…¬å¼ä¸æ­£æ–¹å½¢çš„ä¸€è‡´ï¼Œéƒ½æ˜¯è¾¹é•¿çš„å¹³æ–¹ã€‚
     *
     * è¯¥ç¨‹åºä»¿åˆ»äºï¼š[xphostçš„æ‰«é›·å°æ¸¸æˆ~](https://github.com/xphost008/NovaImitation/blob/dev/frontend/src/views/about/games/Minesweeper.vue)
     */
    window.addEventListener("contextmenu", function (e) {
        // é¦–å…ˆå–æ¶ˆä¸€æ¬¡å³é”®äº‹ä»¶
        e.preventDefault()
    })
    // æ ¼å­æ•°ç»„
    let chessArray = []
    // ç¼–è¾‘æ•°ç»„
    let blockArray = []

    // æ¯ä¸€ä¸ªæ ¼å­æ‰€å±çš„ä¸€ä¸ªç±»ã€‚
    // ä¸ºæ‰€æœ‰æ ¼å­å‡è®¾ç½®ä¸€ä¸ªgetterã€setterå‡½æ•°ï¼Œç”¨æ¥æ›´æ–°DOMã€‚
    class ChessBlock {
        constructor(x, y, p, m, s, c, w) {
            // xï¼šæ ¼å­æ‰€è¿°çš„xåæ ‡ã€‚
            // yï¼šæ ¼å­æ‰€è¿°çš„yåæ ‡
            // pï¼šæ ¼å­æ‰€ä»£è¡¨çš„æ•°å­—ã€-1ï¼šé›·ã€0ï¼šç©ºã€1-8ï¼šåˆ†åˆ«çš„æ•°å­—ã€‘ã€‚
            // mï¼šæ ¼å­çš„è¢«ç‚¹å‡»çŠ¶æ€ã€-1ï¼šå·²è¢«ç‚¹å‡»ã€0ï¼šæœªæ ‡è®°ã€1ï¼šæ——å­ã€2ï¼šé—®å·ã€3ï¼šè¢«ç‚¹åˆ°çš„é›·ï¼ˆèƒŒæ™¯å˜çº¢ï¼‰ã€‚ã€‘
            // sï¼šæ ¼å­åº”è¯¥æ˜¾ç¤ºä»€ä¹ˆã€ç‚¸å¼¹ã€é—®å·ã€æ——å­ã€1-8çš„æ•°å­—ã€‘ï¼ˆå­—ç¬¦ä¸²å½¢å¼ï¼‰
            // wï¼šæ˜¯æ­£ä¸‰è§’è¿˜æ˜¯å€’ä¸‰è§’ï¼ˆæ˜¯æ­£ä¸‰è§’åˆ™ä¸ºtrueï¼Œå¦åˆ™ä¸ºfalseã€‚ï¼‰
            this._x = x;
            this._y = y;
            this._p = p;
            this._m = m;
            this._s = s;
            this._w = w;
        }

        get x() {
            return this._x;
        }

        get y() {
            return this._y;
        }

        get p() {
            return this._p;
        }

        set p(value) {
            chessArray[this._x][this._y].style.color =
                value === 1 ? "rgb(0, 128, 255)" :
                    value === 2 ? "rgb(0, 128, 0)" :
                        value === 3 ? "rgb(192, 0, 0)" :
                            value === 4 ? "rgb(0, 0, 96)" :
                                value === 5 ? "rgb(128, 0, 48)" :
                                    value === 6 ? "rgb(0, 96, 96)" :
                                        value === 7 ? "rgb(10, 10, 10)" :
                                            value === 8 ? "rgb(100, 100, 100)" :
                                                value === 9 ? "rgb(255, 128, 0)" :
                                                    value === 10 ? "rgb(128, 0, 128)" :
                                                        value === 11 ? "rgb(180, 150, 0)" :
                                                            value === 12 ? "rgb(139, 69, 19)" : "black"
            this._p = value;
        }

        get m() {
            return this._m;
        }

        set m(value) {
            chessArray[this._x][this._y].style.cursor = value === -1 || value === 3 ? "default" : "pointer"
            if(value === -1) {
                chessArray[this._x][this._y].style.backgroundColor = "#b0b0b0"
            }else if(value === 3) {
                chessArray[this._x][this._y].style.backgroundColor = "red"
            }
            this._m = value;
        }

        get s() {
            return this._s;
        }

        set s(value) {
            chessArray[this._x][this._y].innerText = value
            this._s = value;
        }

        get w() {
            return this._w;
        }

        set w(value) {
            this._w = value;
        }
    }
    //ä»¥ä¸‹æ˜¯ä¸ç›¸å…³çš„DOMå…ƒç´ 
    const timeDOM = document.getElementById("time")
    const scoreDOM = document.getElementById("score")
    const flagDOM = document.getElementById("flag")
    const winDOM = document.getElementById("win")
    // è¾¹é•¿ã€é›·æ•°~
    const side = document.getElementById("side")
    const mine = document.getElementById("mine")
    // æ£‹ç›˜
    const chess = document.getElementById("chess")
    // ä»¥ä¸‹ä¸ºæ¯ä¸ªDOMå…ƒç´ è®¾ç½®äº†ä¸€ä¸ªGetterã€Setteræ–¹æ³•ï¼Œç”¨æ¥ç®€åŒ–æ“æ§å„ä¸ªå…ƒç´ ~
    // å‰©ä½™æ——å­æ•°
    let flag = {
        _value: 0,
        get value() {
            return this._value
        },
        set value(val) {
            flagDOM.innerText = val.toString()
            this._value = val
        }
    }
    // åˆ†æ•°ï¼ˆæ¯æ­å¼€ä¸€ä¸ªæ ¼å­+10åˆ†ï¼‰
    let score = {
        _value: 0,
        get value() {
            return this._value
        },
        set value(val) {
            scoreDOM.innerText = val.toString()
            this._value = val
        }
    }
    // ä½¿ç”¨æ—¶é—´
    let time = {
        _value: 0,
        get value() {
            return this._value
        },
        set value(val) {
            timeDOM.innerText = val.toString()
            this._value = val
        }
    }
    // æ˜¯å¦è¾“èµ¢ï¼ˆ-1ï¼šä½ è¾“äº†ï¼Œ0ï¼šè¿˜æ²¡åˆ¤æ–­ï¼Œ1ï¼šä½ èµ¢äº†ï¼‰
    let win = {
        _value: 0,
        get value() {
            return this._value
        },
        set value(val) {
            winDOM.style.color = val === -1 ? "red" : val === 1 ? "green" : "black"
            winDOM.innerText = val === -1 ? "ä½ è¾“äº†" : val === 1 ? "ä½ èµ¢äº†" : ""
            this._value = val
        }
    }
    // æ˜¯å¦å¼€å¯ä½œå¼Š
    let cheat = false
    // æ˜¯å¦å¼€å§‹æ¸¸æˆ
    let isStart = false
    // ä¸´æ—¶æ—¶é—´
    let t = 0
    // é”å®šå…¨å±€
    let lock = false
    // æ£‹ç›˜å®é™…è¾¹é•¿
    let si = 0
    // æ£‹ç›˜å®é™…é›·æ•°
    let mi = 0
    // æ£‹ç›˜è®°å½•é›·æ•°
    let count = 0
    // è®°å½•ä¸€ä¸‹æ‰€ç”¨æ—¶é—´~
    setInterval(function () {
        if (!isStart || lock) return
        if (t > 10) {
            t = 0
            time.value++
        }
        t++
    }, 100)
    // ç‚¹å‡»æŸä¸ªæ ¼å­äº§ç”Ÿçš„äº‹ä»¶
    function chessClick(block) {
        // ä»¥ä¸‹ä»£ç ä¸xphostçš„Vueä»£ç ä¸€è‡´~
        if(lock || block === undefined) return
        if(!isStart) isStart = true
        if(![-1, 1, 3].includes(block.m)) {
            block.m = -1
            block.s = block.p === -1 ? "ğŸ’£" : block.p === 0 ? "" : block.p.toString()
            if(block.p === -1) {
                if(cheat) {
                    score.value -= 50
                    block.m = 3
                    flag.value--
                }else{
                    lock = true
                    win.value = -1
                    block.m = 3
                    for(let k = 0; k < si; k++) {
                        for(let l = 0; l <= k * 2; l++) {
                            if(blockArray[k][l].p === -1) {
                                blockArray[k][l].s = "ğŸ’£"
                            }
                        }
                    }
                    return
                }
            }else{
                count++
                score.value += 10
            }
            if(count === si * si - mi) {
                lock = true
                win.value = 1
                return
            }
            if(block.p !== 0) return
            // ä»¥ä¸‹å¼€å§‹é€’å½’è¿ç®—å•¦ï¼Œè¿ç®—æ–¹æ³•å‚è€ƒäº†initNumå‡½æ•°~
            if(block.y >= 1) {
                chessClick(blockArray[block.x][block.y - 1])
            }
            if(block.y >= 2) {
                chessClick(blockArray[block.x][block.y - 2])
            }
            if(block.y <= 2 * block.x - 1) {
                chessClick(blockArray[block.x][block.y + 1])
            }
            if(block.y <= 2 * block.x - 2) {
                chessClick(blockArray[block.x][block.y + 2])
            }
            if(block.x >= 1) {
                chessClick(blockArray[block.x - 1][block.y])
                if(block.y >= 1) {
                    chessClick(blockArray[block.x - 1][block.y - 1])
                }
                if(block.y >= 2) {
                    chessClick(blockArray[block.x - 1][block.y - 2])
                }
            }
            if(block.x < si - 1) {
                chessClick(blockArray[block.x + 1][block.y])
                if(block.y <= 2 * (block.x + 1) - 1) {
                    chessClick(blockArray[block.x + 1][block.y + 1])
                }
                if(block.y <= 2 * (block.x + 1) - 2) {
                    chessClick(blockArray[block.x + 1][block.y + 2])
                }
            }
            if(block.w) {
                if(block.x < si - 1) {
                    if(block.y >= 1) {
                        chessClick(blockArray[block.x + 1][block.y - 1])
                    }
                    if(block.y <= 2 * (block.x + 1) - 3) {
                        chessClick(blockArray[block.x + 1][block.y + 3])
                    }
                }
            }else{
                if(block.x >= 1) {
                    if(block.y >= 3) {
                        chessClick(blockArray[block.x - 1][block.y - 3])
                    }
                    if(block.y <= 2 * (block.x - 1)) {
                        chessClick(blockArray[block.x - 1][block.y + 1])
                    }
                }
            }
        }
    }
    // å³é”®æŸä¸ªæ ¼å­äº§ç”Ÿçš„äº‹ä»¶
    function chessRight(block) {
        if(lock) return
        switch(block.m) {
            case -1:
                let k = 0
                if(block.y >= 1) {
                    if([1, 3].includes(blockArray[block.x][block.y - 1].m)) {
                        k++
                    }
                }
                if(block.y >= 2) {
                    if([1, 3].includes(blockArray[block.x][block.y - 2].m)) {
                        k++
                    }
                }
                if(block.y <= 2 * block.x - 1) {
                    if([1, 3].includes(blockArray[block.x][block.y + 1].m)) {
                        k++
                    }
                }
                if(block.y <= 2 * block.x - 2) {
                    if([1, 3].includes(blockArray[block.x][block.y + 2].m)) {
                        k++
                    }
                }
                if(block.x >= 1) {
                    if([1, 3].includes(blockArray[block.x - 1][block.y].m)) {
                        k++
                    }
                    if(block.y >= 1) {
                        if([1, 3].includes(blockArray[block.x - 1][block.y - 1].m)) {
                            k++
                        }
                    }
                    if(block.y >= 2) {
                        if([1, 3].includes(blockArray[block.x - 1][block.y - 2].m)) {
                            k++
                        }
                    }
                }
                if(block.x < si - 1) {
                    if([1, 3].includes(blockArray[block.x + 1][block.y].m)) {
                        k++
                    }
                    if(block.y <= 2 * (block.x + 1) - 1) {
                        if([1, 3].includes(blockArray[block.x + 1][block.y + 1].m)) {
                            k++
                        }
                    }
                    if(block.y <= 2 * (block.x + 1) - 2) {
                        if([1, 3].includes(blockArray[block.x + 1][block.y + 2].m)) {
                            k++
                        }
                    }
                }
                if(block.w) {
                    if(block.x < si - 1) {
                        if(block.y >= 1) {
                            if([1, 3].includes(blockArray[block.x + 1][block.y - 1].m)) {
                                k++
                            }
                        }
                        if(block.y <= 2 * (block.x + 1) - 3) {
                            if([1, 3].includes(blockArray[block.x + 1][block.y + 3].m)) {
                                k++
                            }
                        }
                    }
                }else{
                    if(block.x >= 1) {
                        if(block.y >= 3) {
                            if([1, 3].includes(blockArray[block.x - 1][block.y - 3].m)) {
                                k++
                            }
                        }
                        if(block.y <= 2 * (block.x - 1)) {
                            if([1, 3].includes(blockArray[block.x - 1][block.y + 1].m)) {
                                k++
                            }
                        }
                    }
                }
                if(block.p > k) return
                if(block.y >= 1) {
                    chessClick(blockArray[block.x][block.y - 1])
                }
                if(block.y >= 2) {
                    chessClick(blockArray[block.x][block.y - 2])
                }
                if(block.y <= 2 * block.x - 1) {
                    chessClick(blockArray[block.x][block.y + 1])
                }
                if(block.y <= 2 * block.x - 2) {
                    chessClick(blockArray[block.x][block.y + 2])
                }
                if(block.x >= 1) {
                    chessClick(blockArray[block.x - 1][block.y])
                    if(block.y >= 1) {
                        chessClick(blockArray[block.x - 1][block.y - 1])
                    }
                    if(block.y >= 2) {
                        chessClick(blockArray[block.x - 1][block.y - 2])
                    }
                }
                if(block.x < si - 1) {
                    chessClick(blockArray[block.x + 1][block.y])
                    if(block.y <= 2 * (block.x + 1) - 1) {
                        chessClick(blockArray[block.x + 1][block.y + 1])
                    }
                    if(block.y <= 2 * (block.x + 1) - 2) {
                        chessClick(blockArray[block.x + 1][block.y + 2])
                    }
                }
                if(block.w) {
                    if(block.x < si - 1) {
                        if(block.y >= 1) {
                            chessClick(blockArray[block.x + 1][block.y - 1])
                        }
                        if(block.y <= 2 * (block.x + 1) - 3) {
                            chessClick(blockArray[block.x + 1][block.y + 3])
                        }
                    }
                }else{
                    if(block.x >= 1) {
                        if(block.y >= 3) {
                            chessClick(blockArray[block.x - 1][block.y - 3])
                        }
                        if(block.y <= 2 * (block.x - 1)) {
                            chessClick(blockArray[block.x - 1][block.y + 1])
                        }
                    }
                }
                break
            case 0:
                if(flag.value > 0) {
                    block.m = 1
                    block.s = 'ğŸš©'
                    flag.value--
                }else{
                    block.m = 2
                    block.s = 'â“'
                }
                break
            case 1:
                block.m = 2
                block.s = 'â“'
                flag.value++
                break
            case 2:
                block.m = 0
                block.s = ""
                break
            default:
                break
        }
    }
    // ç”¨æ¥åšä¸€ä¸ªæ ¼å­çš„æ•°ç»„ï¼Œç”¨äºç”Ÿæˆé›·æ—¶ä»¥ä¾¿äºå¿«é€Ÿåˆ¤æ–­ç”¨ï¼ˆ
    let chessIndexArray = []
    function initArray() {
        blockArray.splice(0, blockArray.length)
        chessArray.splice(0, chessArray.length)
        chessIndexArray.splice(0, chessIndexArray.length)
        chess.innerHTML = ""
        let top = 0;
        for (let i = 0; i < si; i++) {
            chessArray.push([])
            blockArray.push([])
            let left = 0
            for (let j = 0; j < si - i; j++) {
                left += 12
            }
            let b = true
            for (let j = 0; j <= 2 * i; j++) {
                chessArray[i].push(0)
                blockArray[i].push(0)
                let block = new ChessBlock(i, j, 0, 0, "", false, b)
                let chessDiv = document.createElement("div")
                chessDiv.classList.add("triangle")
                chessDiv.style.left = left + "px"
                chessDiv.style.top = top + "px"
                chessDiv.classList.add(b ? "triangle-up" : "triangle-down")
                chessDiv.addEventListener("click", function () {
                    chessClick(block)
                })
                chessDiv.addEventListener("contextmenu", function() {
                    chessRight(block)
                })
                chessArray[i][j] = chessDiv
                blockArray[i][j] = block
                const arr = [i, j]
                chess.appendChild(chessDiv)
                chessIndexArray.push(arr)
                b = !b
                left += 12
            }
            top += 24
        }
    }
    // ç”Ÿæˆé›·çš„å‡½æ•°ï¼ˆé‡‡ç”¨å¾ªç¯éšæœºæ•°ã€å¹¶ä¸”ä½¿ç”¨é€ä¸ªç§»é™¤æ•°ç»„å†…å®¹å®ç°ï¼‰
    function genMine() {
        let count = mi;
        while(count > 0) {
            let rand = Math.floor(Math.random() * chessIndexArray.length)
            let s1 = chessIndexArray[rand][0]
            let s2 = chessIndexArray[rand][1]
            blockArray[s1][s2].p = -1
            chessIndexArray.splice(rand, 1)
            count--
        }
    }
    // ä¸ºæ‰€æœ‰çš„pè®¾ç½®æ•°å­—~
    // é€’å½’æ–¹å¼å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œæ¯•ç«Ÿæœ€é«˜æ•°å­—ä¸º12~
    function initNum() {
        for(let i = 0; i < si; i++) {
            for(let j = 0; j <= 2 * i; j++) {
                if(blockArray[i][j].p === -1) continue
                let foo = 0
                // å‰é¢ä¸¤æ®µä¸€æ ·ï¼Œåˆ°è¿™å°±ä¸ä¸€æ ·äº†~
                // é¦–å…ˆåˆ¤æ–­å·¦å³ä¸¤æ ¼æ˜¯å¦æœ‰é›·ã€‚
                if(j >= 1) {
                    if(blockArray[i][j - 1].p === -1) {
                        foo++
                    }
                }
                if(j >= 2) {
                    if(blockArray[i][j - 2].p === -1) {
                        foo++
                    }
                }
                if(j <= 2 * i - 1) {
                    if(blockArray[i][j + 1].p === -1) {
                        foo++
                    }
                }
                if(j <= 2 * i - 2) {
                    if(blockArray[i][j + 2].p === -1) {
                        foo++
                    }
                }
                // å†æ¥ç€åˆ¤æ–­ä¸Šä¸‹åˆ†åˆ«3æ ¼æ˜¯å¦æœ‰é›·
                if(i >= 1) {
                    if(blockArray[i - 1][j]?.p === -1) {
                        foo++
                    }
                    if(j >= 1) {
                        if(blockArray[i - 1][j - 1]?.p === -1) {
                            foo++
                        }
                    }
                    if(j >= 2) {
                        if(blockArray[i - 1][j - 2].p === -1) {
                            foo++
                        }
                    }
                }
                if(i < si - 1) {
                    if(blockArray[i + 1][j].p === -1) {
                        foo++
                    }
                    if(j <= 2 * (i + 1) - 1) {
                        if(blockArray[i + 1][j + 1].p === -1) {
                            foo++
                        }
                    }
                    if(j <= 2 * (i + 1) - 2) {
                        if(blockArray[i + 1][j + 2].p === -1) {
                            foo++
                        }
                    }
                }
                // æœ€ååˆ¤æ–­æ˜¯æ­£æ˜¯å€’çš„ä¸‰è§’å½¢ï¼Œå¦‚æœæ˜¯æ­£ä¸‰è§’å½¢ï¼Œåˆ™åˆ¤æ–­å·¦ä¸‹å’Œå³ä¸‹ä¸¤ä¸ªè§’è½æ˜¯å¦æœ‰é›·ï¼Œå¦åˆ™åˆ¤æ–­å·¦ä¸Šå’Œå³ä¸Šã€‚
                if(blockArray[i][j].w) {
                    if(i < si - 1) {
                        if(j >= 1) {
                            if(blockArray[i + 1][j - 1].p === -1) {
                                foo++
                            }
                        }
                        if(j <= 2 * (i + 1) - 3) {
                            if(blockArray[i + 1][j + 3]?.p === -1) {
                                foo++
                            }
                        }
                    }
                }else{
                    if(i >= 1) {
                        if(j >= 3) {
                            if(blockArray[i - 1][j - 3].p === -1) {
                                foo++
                            }
                        }
                        if(j <= 2 * (i - 1)) {
                            if(blockArray[i - 1][j + 1]?.p === -1) {
                                foo++
                            }
                        }
                    }
                }
                blockArray[i][j].p = foo
            }
        }
    }
    function start() {
        let s = parseInt(side.value)
        let m = parseInt(mine.value)
        if (Number.isNaN(s) || Number.isNaN(m) || s < 1 || s > 30 || m < 1 || m > s * s - 1) {
            return
        }
        si = s
        mi = m
        initArray()
        genMine()
        initNum()
        isStart = false
        time.value = 0
        score.value = 0
        flag.value = mi
        win.value = 0
        lock = false
        count = 0
    }

    document.getElementById("cheat").addEventListener("change", function () {
        cheat = this.checked;
    })
</script>
</body>
</html>
